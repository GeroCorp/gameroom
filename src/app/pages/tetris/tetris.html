<div class="game-layout">
    <!-- Columna izquierda: Puntaje -->
    <div class="sidebar-left">
        <div class="score-container">
            <h2>Puntaje</h2>
            <div class="score-display">
                <span class="score-number">{{puntuacion}}</span>
                <span class="score-label">puntos</span>
            </div>
            <div class="help-container">
                <div class="next-block"></div>
                <strong>Próximo Bloque</strong>
            </div>
        </div>
    </div>

    <!-- Columna central: Juego principal -->
    <div class="main">
        <div class="header">
            <h1>Tetris</h1>
        </div>
         @if (gameState == "playing" || gameState == "paused") {
        <div class="content">
            <div class="container-juego">
                <div class="display-tetris">
                    <app-grilla></app-grilla>
                </div>
                <div class="botones">

                    <div class="opt-container">
                        <button 
                            appHandleButtons="pause"
                            (click)="togglePause()" 
                            class="opt-button">
                            {{gameState === 'paused' ? 'Reanudar' : 'Pausar'}}
                        </button>
                        <button 
                            appHandleButtons="reset"
                            (click)="resetGame()" 
                            class="opt-button">
                            Reiniciar
                        </button>
                    </div>
                    <div class="gamebtn-container">
                        <button 
                            appHandleButtons="hold"
                            (click)="holdPiece()" 
                            class="game-button">
                            Guardar
                        </button>
                        <button 
                            appHandleButtons="up"
                            (click)="rotatePiece()" 
                            class="game-button">
                            <img [src]="'assets/tetris/rotate.svg'" alt="Rotar">
                        </button>
                        <button 
                            appHandleButtons="drop"
                            (click)="dropPiece()" 
                            class="game-button">
                            <img [src]="'assets/tetris/drop.svg'" alt="Caída rápida">
                        </button>
                        <button 
                            appHandleButtons="left"
                            (click)="movePieceLeft()" 
                            class="game-button">
                            <img [src]="'assets/tetris/left-arrow.svg'" alt="Izquierda">
                        </button>
                        <button 
                            appHandleButtons="right"
                            (click)="movePieceRight()" 
                            class="game-button">
                            <img [src]="'assets/tetris/right-arrow.svg'" alt="Derecha">
                        </button>
                    </div>
                </div>
            </div>
        </div>
        } @else if(gameState == "pregame"){
            <div class="start-game">
                <h3>¡Bienvenido a Tetris!</h3>
                <p>Organiza los bloques para completar líneas y ganar puntos.</p>
                <button class="btn-start-game" (click)="startGame()">
                    <span class="start-icon"></span> Comenzar
                </button>
            </div>
        }
        
        <!-- <app-popup-estado
        *ngIf="estado == 'ganado' || estado == 'perdido'"
        [estado]="estado"
        [palabraSecreta]="palabraSecreta"
        (nuevoJuego)="startNewGame()"
        >
        </app-popup-estado> -->
    </div>

    <!-- Columna derecha: Leaderboard -->
    <div class="sidebar-right">
        <div class="leaderboard-container">
            <h2>LeaderBoard</h2>
            <div class="leaderboard-content">
                @if (loadingScoreboard) {
                    <div class="loading-scores">
                        <p>Cargando puntuaciones...</p>
                    </div>
                } @else if (scoreboard && scoreboard.length > 0) {
                    @for (score of scoreboard; track score.id || $index) {
                        <div class="score-entry">
                            <span class="position">{{$index + 1}}.</span>
                            <span class="player">{{score.username}}</span>
                            <span class="points">{{score.puntuacion}} pts</span>
                        </div>
                    }
                } @else {
                    <div class="no-scores">
                        <p>No hay puntuaciones disponibles</p>
                    </div>
                }
            </div>
        </div>
    </div>
</div>